specVersion: 1.3.0
indexerHints:
  prune: auto
schema:
  file: ./schema.graphql

dataSources:
  - kind: ethereum
    name: AllianceFactory
    network: sepolia
    source:
      address: "0x64EA90E636BB440e5B7eD1E362AEc601B8016938"
      abi: AllianceFactory
      startBlock: 10329464
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.9
      language: wasm/assemblyscript
      entities:
        - Protocol
        - Alliance
      abis:
        - name: AllianceFactory
          file: ./abis/AllianceFactory.json
        - name: Alliance
          file: ./abis/Alliance.json
      eventHandlers:
        - event: AllianceCreated(indexed address,indexed address,indexed address)
          handler: handleAllianceCreated
      file: ./src/alliance-factory.ts

  - kind: ethereum
    name: FATKFaucet
    network: sepolia
    source:
      address: "0xD7971eECAb31a03D5FfEce7b5b65d1060fA3d45F"
      abi: FATKFaucet
      startBlock: 10329465
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.9
      language: wasm/assemblyscript
      entities:
        - Protocol
        - FaucetClaimEvent
      abis:
        - name: FATKFaucet
          file: ./abis/FATKFaucet.json
      eventHandlers:
        - event: Claimed(indexed address,uint256,uint256)
          handler: handleClaimed
      file: ./src/faucet.ts

templates:
  - kind: ethereum/contract
    name: Alliance
    network: sepolia
    source:
      abi: Alliance
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.9
      language: wasm/assemblyscript
      entities:
        - Alliance
        - ParticipantStats
        - DepositEvent
        - RefundEvent
        - NFTBuyEvent
        - SaleVoteEvent
        - SaleExecutionEvent
        - EmergencyVoteEvent
        - EmergencyWithdrawEvent
      abis:
        - name: Alliance
          file: ./abis/Alliance.json
      eventHandlers:
        - event: Deposit(indexed address,uint256)
          handler: handleDeposit
        - event: FundingCancelled()
          handler: handleFundingCancelled
        - event: Refunded(indexed address,uint256)
          handler: handleRefunded
        - event: NFTBought(indexed address,uint256,uint256,indexed address)
          handler: handleNFTBought
        - event: Voted(indexed address,uint256,indexed address,uint256,uint256)
          handler: handleVoted
        - event: SaleExecuted(indexed address,uint256)
          handler: handleSaleExecuted
        - event: EmergencyVoted(indexed address,uint256,indexed address)
          handler: handleEmergencyVoted
        - event: EmergencyWithdrawn(indexed address,indexed address,indexed uint256)
          handler: handleEmergencyWithdrawn
      file: ./src/alliance.ts
